{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/washington/code/nlw-03-projeto-happy/mobile/src/pages/OrphanagesMap/index.tsx\";\n\nimport React, { useState } from 'react';\nimport { Callout, Marker, PROVIDER_GOOGLE } from 'react-native-maps';\nimport { Feather } from '@expo/vector-icons';\nimport { useFocusEffect, useNavigation } from '@react-navigation/native';\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport { requestPermissionsAsync, getCurrentPositionAsync } from 'expo-location';\nimport { Container, Map, CalloutContainer, CalloutText, Footer, FooterText, CreateOrphanageButton } from \"./styles\";\nimport api from \"../../services/api\";\nimport mapMarker from \"../../assets/images/map-marker.png\";\n\nvar OrphanagesMap = function OrphanagesMap() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      orphanages = _useState2[0],\n      setOrphanages = _useState2[1];\n\n  var _useState3 = useState({\n    latitude: 0,\n    longitude: 0\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      initialPosition = _useState4[0],\n      setInitialPosition = _useState4[1];\n\n  var navigation = useNavigation();\n  useFocusEffect(function () {\n    api.get('/orphanages').then(function (res) {\n      setOrphanages(res.data);\n    });\n    loadInitialPosition();\n  });\n\n  function loadInitialPosition() {\n    var _await$requestPermiss, granted, location, _location$coords, latitude, longitude;\n\n    return _regeneratorRuntime.async(function loadInitialPosition$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(requestPermissionsAsync());\n\n          case 2:\n            _await$requestPermiss = _context.sent;\n            granted = _await$requestPermiss.granted;\n\n            if (!granted) {\n              _context.next = 10;\n              break;\n            }\n\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(getCurrentPositionAsync());\n\n          case 7:\n            location = _context.sent;\n            _location$coords = location.coords, latitude = _location$coords.latitude, longitude = _location$coords.longitude;\n            setInitialPosition({\n              latitude: latitude,\n              longitude: longitude\n            });\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return React.createElement(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, React.createElement(StatusBar, {\n    hidden: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }), React.createElement(Map, {\n    provider: PROVIDER_GOOGLE,\n    initialRegion: {\n      latitude: initialPosition.latitude,\n      longitude: initialPosition.longitude,\n      latitudeDelta: 0.008,\n      longitudeDelta: 0.008\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }, orphanages.map(function (orphanage) {\n    return React.createElement(Marker, {\n      key: orphanage.id,\n      icon: mapMarker,\n      calloutAnchor: {\n        x: 2.3,\n        y: 0.72\n      },\n      coordinate: {\n        latitude: orphanage.latitude,\n        longitude: orphanage.longitude\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }\n    }, React.createElement(Callout, {\n      tooltip: true,\n      onPress: function onPress() {\n        navigation.navigate('OrphanageDetails', {\n          id: orphanage.id\n        });\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 15\n      }\n    }, React.createElement(CalloutContainer, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }, React.createElement(CalloutText, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 19\n      }\n    }, orphanage.name))));\n  })), React.createElement(Footer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, React.createElement(FooterText, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, orphanages.length + \" orfanatos encontrados\"), React.createElement(CreateOrphanageButton, {\n    onPress: function onPress() {\n      navigation.navigate('SelectMapPosition');\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, React.createElement(Feather, {\n    name: \"plus\",\n    color: \"#fff\",\n    size: 24,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default OrphanagesMap;","map":{"version":3,"sources":["/Users/washington/code/nlw-03-projeto-happy/mobile/src/pages/OrphanagesMap/index.tsx"],"names":["React","useState","Callout","Marker","PROVIDER_GOOGLE","Feather","useFocusEffect","useNavigation","requestPermissionsAsync","getCurrentPositionAsync","Container","Map","CalloutContainer","CalloutText","Footer","FooterText","CreateOrphanageButton","api","mapMarker","OrphanagesMap","orphanages","setOrphanages","latitude","longitude","initialPosition","setInitialPosition","navigation","get","then","res","data","loadInitialPosition","granted","location","coords","latitudeDelta","longitudeDelta","map","orphanage","id","x","y","navigate","name","length"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Callout, Marker, PROVIDER_GOOGLE } from 'react-native-maps';\nimport { Feather } from '@expo/vector-icons';\nimport { useFocusEffect, useNavigation } from '@react-navigation/native';\nimport { StatusBar } from 'react-native';\nimport {\n  requestPermissionsAsync,\n  getCurrentPositionAsync,\n} from 'expo-location';\n\nimport {\n  Container,\n  Map,\n  CalloutContainer,\n  CalloutText,\n  Footer,\n  FooterText,\n  CreateOrphanageButton,\n} from './styles';\n\nimport api from '../../services/api';\n\nimport mapMarker from '../../assets/images/map-marker.png';\n\ninterface Orphanage {\n  id: string;\n  name: string;\n  latitude: number;\n  longitude: number;\n}\n\nconst OrphanagesMap: React.FC = () => {\n  const [orphanages, setOrphanages] = useState<Orphanage[]>([]);\n  const [initialPosition, setInitialPosition] = useState({\n    latitude: 0,\n    longitude: 0,\n  });\n\n  const navigation = useNavigation();\n\n  useFocusEffect(() => {\n    api.get('/orphanages').then(res => {\n      setOrphanages(res.data);\n    });\n\n    loadInitialPosition();\n  });\n\n  async function loadInitialPosition() {\n    const { granted } = await requestPermissionsAsync();\n\n    if (granted) {\n      const location = await getCurrentPositionAsync();\n\n      const { latitude, longitude } = location.coords;\n\n      setInitialPosition({ latitude, longitude });\n    }\n  }\n\n  return (\n    <Container>\n      <StatusBar hidden />\n\n      <Map\n        provider={PROVIDER_GOOGLE}\n        initialRegion={{\n          latitude: initialPosition.latitude,\n          longitude: initialPosition.longitude,\n          latitudeDelta: 0.008,\n          longitudeDelta: 0.008,\n        }}\n      >\n        {orphanages.map(orphanage => {\n          return (\n            <Marker\n              key={orphanage.id}\n              icon={mapMarker}\n              calloutAnchor={{\n                x: 2.3,\n                y: 0.72,\n              }}\n              coordinate={{\n                latitude: orphanage.latitude,\n                longitude: orphanage.longitude,\n              }}\n            >\n              <Callout\n                tooltip\n                onPress={() => {\n                  navigation.navigate('OrphanageDetails', { id: orphanage.id });\n                }}\n              >\n                <CalloutContainer>\n                  <CalloutText>{orphanage.name}</CalloutText>\n                </CalloutContainer>\n              </Callout>\n            </Marker>\n          );\n        })}\n      </Map>\n\n      <Footer>\n        <FooterText>{`${orphanages.length} orfanatos encontrados`}</FooterText>\n        <CreateOrphanageButton\n          onPress={() => {\n            navigation.navigate('SelectMapPosition');\n          }}\n        >\n          <Feather name=\"plus\" color=\"#fff\" size={24} />\n        </CreateOrphanageButton>\n      </Footer>\n    </Container>\n  );\n};\n\nexport default OrphanagesMap;\n"]},"metadata":{},"sourceType":"module"}